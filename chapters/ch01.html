<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Asciidoctor 2.0.17">
    <title>Introduction</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
    <style>
        /*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
        /* Uncomment the following line when using as a custom stylesheet */
        /* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
        html {
            font-family: sans-serif;
            -webkit-text-size-adjust: 100%
        }

        a {
            background: none
        }

        a:focus {
            outline: thin dotted
        }

        a:active, a:hover {
            outline: 0
        }

        h1 {
            font-size: 2em;
            margin: .67em 0
        }

        b, strong {
            font-weight: bold
        }

        abbr {
            font-size: .9em
        }

        abbr[title] {
            cursor: help;
            border-bottom: 1px dotted #dddddf;
            text-decoration: none
        }

        dfn {
            font-style: italic
        }

        hr {
            height: 0
        }

        mark {
            background: #ff0;
            color: #000
        }

        code, kbd, pre, samp {
            font-family: monospace;
            font-size: 1em
        }

        pre {
            white-space: pre-wrap
        }

        q {
            quotes: "\201C" "\201D" "\2018" "\2019"
        }

        small {
            font-size: 80%
        }

        sub, sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        img {
            border: 0
        }

        svg:not(:root) {
            overflow: hidden
        }

        figure {
            margin: 0
        }

        audio, video {
            display: inline-block
        }

        audio:not([controls]) {
            display: none;
            height: 0
        }

        fieldset {
            border: 1px solid silver;
            margin: 0 2px;
            padding: .35em .625em .75em
        }

        legend {
            border: 0;
            padding: 0
        }

        button, input, select, textarea {
            font-family: inherit;
            font-size: 100%;
            margin: 0
        }

        button, input {
            line-height: normal
        }

        button, select {
            text-transform: none
        }

        button, html input[type=button], input[type=reset], input[type=submit] {
            -webkit-appearance: button;
            cursor: pointer
        }

        button[disabled], html input[disabled] {
            cursor: default
        }

        input[type=checkbox], input[type=radio] {
            padding: 0
        }

        button::-moz-focus-inner, input::-moz-focus-inner {
            border: 0;
            padding: 0
        }

        textarea {
            overflow: auto;
            vertical-align: top
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        *, ::before, ::after {
            box-sizing: border-box
        }

        html, body {
            font-size: 100%
        }

        body {
            background: #fff;
            color: rgba(0, 0, 0, .8);
            padding: 0;
            margin: 0;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            line-height: 1;
            position: relative;
            cursor: auto;
            -moz-tab-size: 4;
            -o-tab-size: 4;
            tab-size: 4;
            word-wrap: anywhere;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased
        }

        a:hover {
            cursor: pointer
        }

        img, object, embed {
            max-width: 100%;
            height: auto
        }

        object, embed {
            height: 100%
        }

        img {
            -ms-interpolation-mode: bicubic
        }

        .left {
            float: left !important
        }

        .right {
            float: right !important
        }

        .text-left {
            text-align: left !important
        }

        .text-right {
            text-align: right !important
        }

        .text-center {
            text-align: center !important
        }

        .text-justify {
            text-align: justify !important
        }

        .hide {
            display: none
        }

        img, object, svg {
            display: inline-block;
            vertical-align: middle
        }

        textarea {
            height: auto;
            min-height: 50px
        }

        select {
            width: 100%
        }

        .subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
            line-height: 1.45;
            color: #7a2518;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: .25em
        }

        div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td {
            margin: 0;
            padding: 0
        }

        a {
            color: #2156a5;
            text-decoration: underline;
            line-height: inherit
        }

        a:hover, a:focus {
            color: #1d4b8f
        }

        a img {
            border: 0
        }

        p {
            line-height: 1.6;
            margin-bottom: 1.25em;
            text-rendering: optimizeLegibility
        }

        p aside {
            font-size: .875em;
            line-height: 1.35;
            font-style: italic
        }

        h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-weight: 300;
            font-style: normal;
            color: #ba3925;
            text-rendering: optimizeLegibility;
            margin-top: 1em;
            margin-bottom: .5em;
            line-height: 1.0125em
        }

        h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
            font-size: 60%;
            color: #e99b8f;
            line-height: 0
        }

        h1 {
            font-size: 2.125em
        }

        h2 {
            font-size: 1.6875em
        }

        h3, #toctitle, .sidebarblock > .content > .title {
            font-size: 1.375em
        }

        h4, h5 {
            font-size: 1.125em
        }

        h6 {
            font-size: 1em
        }

        hr {
            border: solid #dddddf;
            border-width: 1px 0 0;
            clear: both;
            margin: 1.25em 0 1.1875em
        }

        em, i {
            font-style: italic;
            line-height: inherit
        }

        strong, b {
            font-weight: bold;
            line-height: inherit
        }

        small {
            font-size: 60%;
            line-height: inherit
        }

        code {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            font-weight: 400;
            color: rgba(0, 0, 0, .9)
        }

        ul, ol, dl {
            line-height: 1.6;
            margin-bottom: 1.25em;
            list-style-position: outside;
            font-family: inherit
        }

        ul, ol {
            margin-left: 1.5em
        }

        ul li ul, ul li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }

        ul.square li ul, ul.circle li ul, ul.disc li ul {
            list-style: inherit
        }

        ul.square {
            list-style-type: square
        }

        ul.circle {
            list-style-type: circle
        }

        ul.disc {
            list-style-type: disc
        }

        ol li ul, ol li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }

        dl dt {
            margin-bottom: .3125em;
            font-weight: bold
        }

        dl dd {
            margin-bottom: 1.25em
        }

        blockquote {
            margin: 0 0 1.25em;
            padding: .5625em 1.25em 0 1.1875em;
            border-left: 1px solid #ddd
        }

        blockquote, blockquote p {
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }

        @media screen and (min-width: 768px) {
            h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
                line-height: 1.2
            }

            h1 {
                font-size: 2.75em
            }

            h2 {
                font-size: 2.3125em
            }

            h3, #toctitle, .sidebarblock > .content > .title {
                font-size: 1.6875em
            }

            h4 {
                font-size: 1.4375em
            }
        }

        table {
            background: #fff;
            margin-bottom: 1.25em;
            border: 1px solid #dedede;
            word-wrap: normal
        }

        table thead, table tfoot {
            background: #f7f8f7
        }

        table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
            padding: .5em .625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8);
            text-align: left
        }

        table tr th, table tr td {
            padding: .5625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8)
        }

        table tr.even, table tr.alt {
            background: #f8f8f7
        }

        table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
            line-height: 1.6
        }

        h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
            line-height: 1.2;
            word-spacing: -.05em
        }

        h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong {
            font-weight: 400
        }

        .center {
            margin-left: auto;
            margin-right: auto
        }

        .stretch {
            width: 100%
        }

        .clearfix::before, .clearfix::after, .float-group::before, .float-group::after {
            content: " ";
            display: table
        }

        .clearfix::after, .float-group::after {
            clear: both
        }

        :not(pre).nobreak {
            word-wrap: normal
        }

        :not(pre).nowrap {
            white-space: nowrap
        }

        :not(pre).pre-wrap {
            white-space: pre-wrap
        }

        :not(pre):not([class^=L]) > code {
            font-size: .9375em;
            font-style: normal !important;
            letter-spacing: 0;
            padding: .1em .5ex;
            word-spacing: -.15em;
            background: #f7f7f8;
            border-radius: 4px;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }

        pre {
            color: rgba(0, 0, 0, .9);
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            line-height: 1.45;
            text-rendering: optimizeSpeed
        }

        pre code, pre pre {
            color: inherit;
            font-size: inherit;
            line-height: inherit
        }

        pre > code {
            display: block
        }

        pre.nowrap, pre.nowrap pre {
            white-space: pre;
            word-wrap: normal
        }

        em em {
            font-style: normal
        }

        strong strong {
            font-weight: 400
        }

        .keyseq {
            color: rgba(51, 51, 51, .8)
        }

        kbd {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            display: inline-block;
            color: rgba(0, 0, 0, .8);
            font-size: .65em;
            line-height: 1.45;
            background: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 3px;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .2), inset 0 0 0 .1em #fff;
            margin: 0 .15em;
            padding: .2em .5em;
            vertical-align: middle;
            position: relative;
            top: -.1em;
            white-space: nowrap
        }

        .keyseq kbd:first-child {
            margin-left: 0
        }

        .keyseq kbd:last-child {
            margin-right: 0
        }

        .menuseq, .menuref {
            color: #000
        }

        .menuseq b:not(.caret), .menuref {
            font-weight: inherit
        }

        .menuseq {
            word-spacing: -.02em
        }

        .menuseq b.caret {
            font-size: 1.25em;
            line-height: .8
        }

        .menuseq i.caret {
            font-weight: bold;
            text-align: center;
            width: .45em
        }

        b.button::before, b.button::after {
            position: relative;
            top: -1px;
            font-weight: 400
        }

        b.button::before {
            content: "[";
            padding: 0 3px 0 2px
        }

        b.button::after {
            content: "]";
            padding: 0 2px 0 3px
        }

        p a > code:hover {
            color: rgba(0, 0, 0, .9)
        }

        #header, #content, #footnotes, #footer {
            width: 100%;
            margin: 0 auto;
            max-width: 62.5em;
            *zoom: 1;
            position: relative;
            padding-left: .9375em;
            padding-right: .9375em
        }

        #header::before, #header::after, #content::before, #content::after, #footnotes::before, #footnotes::after, #footer::before, #footer::after {
            content: " ";
            display: table
        }

        #header::after, #content::after, #footnotes::after, #footer::after {
            clear: both
        }

        #content {
            margin-top: 1.25em
        }

        #content::before {
            content: none
        }

        #header > h1:first-child {
            color: rgba(0, 0, 0, .85);
            margin-top: 2.25rem;
            margin-bottom: 0
        }

        #header > h1:first-child + #toc {
            margin-top: 8px;
            border-top: 1px solid #dddddf
        }

        #header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) {
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px
        }

        #header .details {
            border-bottom: 1px solid #dddddf;
            line-height: 1.45;
            padding-top: .25em;
            padding-bottom: .25em;
            padding-left: .25em;
            color: rgba(0, 0, 0, .6);
            display: flex;
            flex-flow: row wrap
        }

        #header .details span:first-child {
            margin-left: -.125em
        }

        #header .details span.email a {
            color: rgba(0, 0, 0, .85)
        }

        #header .details br {
            display: none
        }

        #header .details br + span::before {
            content: "\00a0\2013\00a0"
        }

        #header .details br + span.author::before {
            content: "\00a0\22c5\00a0";
            color: rgba(0, 0, 0, .85)
        }

        #header .details br + span#revremark::before {
            content: "\00a0|\00a0"
        }

        #header #revnumber {
            text-transform: capitalize
        }

        #header #revnumber::after {
            content: "\00a0"
        }

        #content > h1:first-child:not([class]) {
            color: rgba(0, 0, 0, .85);
            border-bottom: 1px solid #dddddf;
            padding-bottom: 8px;
            margin-top: 0;
            padding-top: 1rem;
            margin-bottom: 1.25rem
        }

        #toc {
            border-bottom: 1px solid #e7e7e9;
            padding-bottom: .5em
        }

        #toc > ul {
            margin-left: .125em
        }

        #toc ul.sectlevel0 > li > a {
            font-style: italic
        }

        #toc ul.sectlevel0 ul.sectlevel1 {
            margin: .5em 0
        }

        #toc ul {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            list-style-type: none
        }

        #toc li {
            line-height: 1.3334;
            margin-top: .3334em
        }

        #toc a {
            text-decoration: none
        }

        #toc a:active {
            text-decoration: underline
        }

        #toctitle {
            color: #7a2518;
            font-size: 1.2em
        }

        @media screen and (min-width: 768px) {
            #toctitle {
                font-size: 1.375em
            }

            body.toc2 {
                padding-left: 15em;
                padding-right: 0
            }

            #toc.toc2 {
                margin-top: 0 !important;
                background: #f8f8f7;
                position: fixed;
                width: 15em;
                left: 0;
                top: 0;
                border-right: 1px solid #e7e7e9;
                border-top-width: 0 !important;
                border-bottom-width: 0 !important;
                z-index: 1000;
                padding: 1.25em 1em;
                height: 100%;
                overflow: auto
            }

            #toc.toc2 #toctitle {
                margin-top: 0;
                margin-bottom: .8rem;
                font-size: 1.2em
            }

            #toc.toc2 > ul {
                font-size: .9em;
                margin-bottom: 0
            }

            #toc.toc2 ul ul {
                margin-left: 0;
                padding-left: 1em
            }

            #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
                padding-left: 0;
                margin-top: .5em;
                margin-bottom: .5em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 15em
            }

            body.toc2.toc-right #toc.toc2 {
                border-right-width: 0;
                border-left: 1px solid #e7e7e9;
                left: auto;
                right: 0
            }
        }

        @media screen and (min-width: 1280px) {
            body.toc2 {
                padding-left: 20em;
                padding-right: 0
            }

            #toc.toc2 {
                width: 20em
            }

            #toc.toc2 #toctitle {
                font-size: 1.375em
            }

            #toc.toc2 > ul {
                font-size: .95em
            }

            #toc.toc2 ul ul {
                padding-left: 1.25em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 20em
            }
        }

        #content #toc {
            border: 1px solid #e0e0dc;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f8f8f7;
            border-radius: 4px
        }

        #content #toc > :first-child {
            margin-top: 0
        }

        #content #toc > :last-child {
            margin-bottom: 0
        }

        #footer {
            max-width: none;
            background: rgba(0, 0, 0, .8);
            padding: 1.25em
        }

        .footer-text {
            color: hsla(0, 0%, 100%, .8);
            line-height: 1.44
        }

        #content {
            margin-bottom: .625em
        }

        .sect1 {
            padding-bottom: .625em
        }

        @media screen and (min-width: 768px) {
            #content {
                margin-bottom: 1.25em
            }

            .sect1 {
                padding-bottom: 1.25em
            }
        }

        .sect1:last-child {
            padding-bottom: 0
        }

        .sect1 + .sect1 {
            border-top: 1px solid #e7e7e9
        }

        #content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor {
            position: absolute;
            z-index: 1001;
            width: 1.5ex;
            margin-left: -1.5ex;
            display: block;
            text-decoration: none !important;
            visibility: hidden;
            text-align: center;
            font-weight: 400
        }

        #content h1 > a.anchor::before, h2 > a.anchor::before, h3 > a.anchor::before, #toctitle > a.anchor::before, .sidebarblock > .content > .title > a.anchor::before, h4 > a.anchor::before, h5 > a.anchor::before, h6 > a.anchor::before {
            content: "\00A7";
            font-size: .85em;
            display: block;
            padding-top: .1em
        }

        #content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover {
            visibility: visible
        }

        #content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
            color: #ba3925;
            text-decoration: none
        }

        #content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover {
            color: #a53221
        }

        details, .audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock {
            margin-bottom: 1.25em
        }

        details {
            margin-left: 1.25rem
        }

        details > summary {
            cursor: pointer;
            display: block;
            position: relative;
            line-height: 1.6;
            margin-bottom: .625rem;
            outline: none;
            -webkit-tap-highlight-color: transparent
        }

        details > summary::-webkit-details-marker {
            display: none
        }

        details > summary::before {
            content: "";
            border: solid transparent;
            border-left: solid;
            border-width: .3em 0 .3em .5em;
            position: absolute;
            top: .5em;
            left: -1.25rem;
            transform: translateX(15%)
        }

        details[open] > summary::before {
            border: solid transparent;
            border-top: solid;
            border-width: .5em .3em 0;
            transform: translateY(15%)
        }

        details > summary::after {
            content: "";
            width: 1.25rem;
            height: 1em;
            position: absolute;
            top: .3em;
            left: -1.25rem
        }

        .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
            text-rendering: optimizeLegibility;
            text-align: left;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-size: 1rem;
            font-style: italic
        }

        table.tableblock.fit-content > caption.title {
            white-space: nowrap;
            width: 0
        }

        .paragraph.lead > p, #preamble > .sectionbody > [class=paragraph]:first-of-type p {
            font-size: 1.21875em;
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }

        .admonitionblock > table {
            border-collapse: separate;
            border: 0;
            background: none;
            width: 100%
        }

        .admonitionblock > table td.icon {
            text-align: center;
            width: 80px
        }

        .admonitionblock > table td.icon img {
            max-width: none
        }

        .admonitionblock > table td.icon .title {
            font-weight: bold;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            text-transform: uppercase
        }

        .admonitionblock > table td.content {
            padding-left: 1.125em;
            padding-right: 1.25em;
            border-left: 1px solid #dddddf;
            color: rgba(0, 0, 0, .6);
            word-wrap: anywhere
        }

        .admonitionblock > table td.content > :last-child > :last-child {
            margin-bottom: 0
        }

        .exampleblock > .content {
            border: 1px solid #e6e6e6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #fff;
            border-radius: 4px
        }

        .exampleblock > .content > :first-child {
            margin-top: 0
        }

        .exampleblock > .content > :last-child {
            margin-bottom: 0
        }

        .sidebarblock {
            border: 1px solid #dbdbd6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f3f3f2;
            border-radius: 4px
        }

        .sidebarblock > :first-child {
            margin-top: 0
        }

        .sidebarblock > :last-child {
            margin-bottom: 0
        }

        .sidebarblock > .content > .title {
            color: #7a2518;
            margin-top: 0;
            text-align: center
        }

        .exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child {
            margin-bottom: 0
        }

        .literalblock pre, .listingblock > .content > pre {
            border-radius: 4px;
            overflow-x: auto;
            padding: 1em;
            font-size: .8125em
        }

        @media screen and (min-width: 768px) {
            .literalblock pre, .listingblock > .content > pre {
                font-size: .90625em
            }
        }

        @media screen and (min-width: 1280px) {
            .literalblock pre, .listingblock > .content > pre {
                font-size: 1em
            }
        }

        .literalblock pre, .listingblock > .content > pre:not(.highlight), .listingblock > .content > pre[class=highlight], .listingblock > .content > pre[class^="highlight "] {
            background: #f7f7f8
        }

        .literalblock.output pre {
            color: #f7f7f8;
            background: rgba(0, 0, 0, .9)
        }

        .listingblock > .content {
            position: relative
        }

        .listingblock code[data-lang]::before {
            display: none;
            content: attr(data-lang);
            position: absolute;
            font-size: .75em;
            top: .425rem;
            right: .5rem;
            line-height: 1;
            text-transform: uppercase;
            color: inherit;
            opacity: .5
        }

        .listingblock:hover code[data-lang]::before {
            display: block
        }

        .listingblock.terminal pre .command::before {
            content: attr(data-prompt);
            padding-right: .5em;
            color: inherit;
            opacity: .5
        }

        .listingblock.terminal pre .command:not([data-prompt])::before {
            content: "$"
        }

        .listingblock pre.highlightjs {
            padding: 0
        }

        .listingblock pre.highlightjs > code {
            padding: 1em;
            border-radius: 4px
        }

        .listingblock pre.prettyprint {
            border-width: 0
        }

        .prettyprint {
            background: #f7f7f8
        }

        pre.prettyprint .linenums {
            line-height: 1.45;
            margin-left: 2em
        }

        pre.prettyprint li {
            background: none;
            list-style-type: inherit;
            padding-left: 0
        }

        pre.prettyprint li code[data-lang]::before {
            opacity: 1
        }

        pre.prettyprint li:not(:first-child) code[data-lang]::before {
            display: none
        }

        table.linenotable {
            border-collapse: separate;
            border: 0;
            margin-bottom: 0;
            background: none
        }

        table.linenotable td[class] {
            color: inherit;
            vertical-align: top;
            padding: 0;
            line-height: inherit;
            white-space: normal
        }

        table.linenotable td.code {
            padding-left: .75em
        }

        table.linenotable td.linenos, pre.pygments .linenos {
            border-right: 1px solid;
            opacity: .35;
            padding-right: .5em;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        pre.pygments span.linenos {
            display: inline-block;
            margin-right: .75em
        }

        .quoteblock {
            margin: 0 1em 1.25em 1.5em;
            display: table
        }

        .quoteblock:not(.excerpt) > .title {
            margin-left: -1.5em;
            margin-bottom: .75em
        }

        .quoteblock blockquote, .quoteblock p {
            color: rgba(0, 0, 0, .85);
            font-size: 1.15rem;
            line-height: 1.75;
            word-spacing: .1em;
            letter-spacing: 0;
            font-style: italic;
            text-align: justify
        }

        .quoteblock blockquote {
            margin: 0;
            padding: 0;
            border: 0
        }

        .quoteblock blockquote::before {
            content: "\201c";
            float: left;
            font-size: 2.75em;
            font-weight: bold;
            line-height: .6em;
            margin-left: -.6em;
            color: #7a2518;
            text-shadow: 0 1px 2px rgba(0, 0, 0, .1)
        }

        .quoteblock blockquote > .paragraph:last-child p {
            margin-bottom: 0
        }

        .quoteblock .attribution {
            margin-top: .75em;
            margin-right: .5ex;
            text-align: right
        }

        .verseblock {
            margin: 0 1em 1.25em
        }

        .verseblock pre {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-size: 1.15rem;
            color: rgba(0, 0, 0, .85);
            font-weight: 300;
            text-rendering: optimizeLegibility
        }

        .verseblock pre strong {
            font-weight: 400
        }

        .verseblock .attribution {
            margin-top: 1.25rem;
            margin-left: .5ex
        }

        .quoteblock .attribution, .verseblock .attribution {
            font-size: .9375em;
            line-height: 1.45;
            font-style: italic
        }

        .quoteblock .attribution br, .verseblock .attribution br {
            display: none
        }

        .quoteblock .attribution cite, .verseblock .attribution cite {
            display: block;
            letter-spacing: -.025em;
            color: rgba(0, 0, 0, .6)
        }

        .quoteblock.abstract blockquote::before, .quoteblock.excerpt blockquote::before, .quoteblock .quoteblock blockquote::before {
            display: none
        }

        .quoteblock.abstract blockquote, .quoteblock.abstract p, .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p {
            line-height: 1.6;
            word-spacing: 0
        }

        .quoteblock.abstract {
            margin: 0 1em 1.25em;
            display: block
        }

        .quoteblock.abstract > .title {
            margin: 0 0 .375em;
            font-size: 1.15em;
            text-align: center
        }

        .quoteblock.excerpt > blockquote, .quoteblock .quoteblock {
            padding: 0 0 .25em 1em;
            border-left: .25em solid #dddddf
        }

        .quoteblock.excerpt, .quoteblock .quoteblock {
            margin-left: 0
        }

        .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p {
            color: inherit;
            font-size: 1.0625rem
        }

        .quoteblock.excerpt .attribution, .quoteblock .quoteblock .attribution {
            color: inherit;
            font-size: .85rem;
            text-align: left;
            margin-right: 0
        }

        p.tableblock:last-child {
            margin-bottom: 0
        }

        td.tableblock > .content {
            margin-bottom: 1.25em;
            word-wrap: anywhere
        }

        td.tableblock > .content > :last-child {
            margin-bottom: -1.25em
        }

        table.tableblock, th.tableblock, td.tableblock {
            border: 0 solid #dedede
        }

        table.grid-all > * > tr > * {
            border-width: 1px
        }

        table.grid-cols > * > tr > * {
            border-width: 0 1px
        }

        table.grid-rows > * > tr > * {
            border-width: 1px 0
        }

        table.frame-all {
            border-width: 1px
        }

        table.frame-ends {
            border-width: 1px 0
        }

        table.frame-sides {
            border-width: 0 1px
        }

        table.frame-none > colgroup + * > :first-child > *, table.frame-sides > colgroup + * > :first-child > * {
            border-top-width: 0
        }

        table.frame-none > :last-child > :last-child > *, table.frame-sides > :last-child > :last-child > * {
            border-bottom-width: 0
        }

        table.frame-none > * > tr > :first-child, table.frame-ends > * > tr > :first-child {
            border-left-width: 0
        }

        table.frame-none > * > tr > :last-child, table.frame-ends > * > tr > :last-child {
            border-right-width: 0
        }

        table.stripes-all > * > tr, table.stripes-odd > * > tr:nth-of-type(odd), table.stripes-even > * > tr:nth-of-type(even), table.stripes-hover > * > tr:hover {
            background: #f8f8f7
        }

        th.halign-left, td.halign-left {
            text-align: left
        }

        th.halign-right, td.halign-right {
            text-align: right
        }

        th.halign-center, td.halign-center {
            text-align: center
        }

        th.valign-top, td.valign-top {
            vertical-align: top
        }

        th.valign-bottom, td.valign-bottom {
            vertical-align: bottom
        }

        th.valign-middle, td.valign-middle {
            vertical-align: middle
        }

        table thead th, table tfoot th {
            font-weight: bold
        }

        tbody tr th {
            background: #f7f8f7
        }

        tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
            color: rgba(0, 0, 0, .8);
            font-weight: bold
        }

        p.tableblock > code:only-child {
            background: none;
            padding: 0
        }

        p.tableblock {
            font-size: 1em
        }

        ol {
            margin-left: 1.75em
        }

        ul li ol {
            margin-left: 1.5em
        }

        dl dd {
            margin-left: 1.125em
        }

        dl dd:last-child, dl dd:last-child > :last-child {
            margin-bottom: 0
        }

        li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist {
            margin-bottom: .625em
        }

        ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled {
            list-style-type: none
        }

        ul.no-bullet, ol.no-bullet, ol.unnumbered {
            margin-left: .625em
        }

        ul.unstyled, ol.unstyled {
            margin-left: 0
        }

        li > p:empty:only-child::before {
            content: "";
            display: inline-block
        }

        ul.checklist > li > p:first-child {
            margin-left: -1em
        }

        ul.checklist > li > p:first-child > .fa-square-o:first-child, ul.checklist > li > p:first-child > .fa-check-square-o:first-child {
            width: 1.25em;
            font-size: .8em;
            position: relative;
            bottom: .125em
        }

        ul.checklist > li > p:first-child > input[type=checkbox]:first-child {
            margin-right: .25em
        }

        ul.inline {
            display: flex;
            flex-flow: row wrap;
            list-style: none;
            margin: 0 0 .625em -1.25em
        }

        ul.inline > li {
            margin-left: 1.25em
        }

        .unstyled dl dt {
            font-weight: 400;
            font-style: normal
        }

        ol.arabic {
            list-style-type: decimal
        }

        ol.decimal {
            list-style-type: decimal-leading-zero
        }

        ol.loweralpha {
            list-style-type: lower-alpha
        }

        ol.upperalpha {
            list-style-type: upper-alpha
        }

        ol.lowerroman {
            list-style-type: lower-roman
        }

        ol.upperroman {
            list-style-type: upper-roman
        }

        ol.lowergreek {
            list-style-type: lower-greek
        }

        .hdlist > table, .colist > table {
            border: 0;
            background: none
        }

        .hdlist > table > tbody > tr, .colist > table > tbody > tr {
            background: none
        }

        td.hdlist1, td.hdlist2 {
            vertical-align: top;
            padding: 0 .625em
        }

        td.hdlist1 {
            font-weight: bold;
            padding-bottom: 1.25em
        }

        td.hdlist2 {
            word-wrap: anywhere
        }

        .literalblock + .colist, .listingblock + .colist {
            margin-top: -.5em
        }

        .colist td:not([class]):first-child {
            padding: .4em .75em 0;
            line-height: 1;
            vertical-align: top
        }

        .colist td:not([class]):first-child img {
            max-width: none
        }

        .colist td:not([class]):last-child {
            padding: .25em 0
        }

        .thumb, .th {
            line-height: 0;
            display: inline-block;
            border: 4px solid #fff;
            box-shadow: 0 0 0 1px #ddd
        }

        .imageblock.left {
            margin: .25em .625em 1.25em 0
        }

        .imageblock.right {
            margin: .25em 0 1.25em .625em
        }

        .imageblock > .title {
            margin-bottom: 0
        }

        .imageblock.thumb, .imageblock.th {
            border-width: 6px
        }

        .imageblock.thumb > .title, .imageblock.th > .title {
            padding: 0 .125em
        }

        .image.left, .image.right {
            margin-top: .25em;
            margin-bottom: .25em;
            display: inline-block;
            line-height: 0
        }

        .image.left {
            margin-right: .625em
        }

        .image.right {
            margin-left: .625em
        }

        a.image {
            text-decoration: none;
            display: inline-block
        }

        a.image object {
            pointer-events: none
        }

        sup.footnote, sup.footnoteref {
            font-size: .875em;
            position: static;
            vertical-align: super
        }

        sup.footnote a, sup.footnoteref a {
            text-decoration: none
        }

        sup.footnote a:active, sup.footnoteref a:active {
            text-decoration: underline
        }

        #footnotes {
            padding-top: .75em;
            padding-bottom: .75em;
            margin-bottom: .625em
        }

        #footnotes hr {
            width: 20%;
            min-width: 6.25em;
            margin: -.25em 0 .75em;
            border-width: 1px 0 0
        }

        #footnotes .footnote {
            padding: 0 .375em 0 .225em;
            line-height: 1.3334;
            font-size: .875em;
            margin-left: 1.2em;
            margin-bottom: .2em
        }

        #footnotes .footnote a:first-of-type {
            font-weight: bold;
            text-decoration: none;
            margin-left: -1.05em
        }

        #footnotes .footnote:last-of-type {
            margin-bottom: 0
        }

        #content #footnotes {
            margin-top: -.625em;
            margin-bottom: 0;
            padding: .75em 0
        }

        div.unbreakable {
            page-break-inside: avoid
        }

        .big {
            font-size: larger
        }

        .small {
            font-size: smaller
        }

        .underline {
            text-decoration: underline
        }

        .overline {
            text-decoration: overline
        }

        .line-through {
            text-decoration: line-through
        }

        .aqua {
            color: #00bfbf
        }

        .aqua-background {
            background: #00fafa
        }

        .black {
            color: #000
        }

        .black-background {
            background: #000
        }

        .blue {
            color: #0000bf
        }

        .blue-background {
            background: #0000fa
        }

        .fuchsia {
            color: #bf00bf
        }

        .fuchsia-background {
            background: #fa00fa
        }

        .gray {
            color: #606060
        }

        .gray-background {
            background: #7d7d7d
        }

        .green {
            color: #006000
        }

        .green-background {
            background: #007d00
        }

        .lime {
            color: #00bf00
        }

        .lime-background {
            background: #00fa00
        }

        .maroon {
            color: #600000
        }

        .maroon-background {
            background: #7d0000
        }

        .navy {
            color: #000060
        }

        .navy-background {
            background: #00007d
        }

        .olive {
            color: #606000
        }

        .olive-background {
            background: #7d7d00
        }

        .purple {
            color: #600060
        }

        .purple-background {
            background: #7d007d
        }

        .red {
            color: #bf0000
        }

        .red-background {
            background: #fa0000
        }

        .silver {
            color: #909090
        }

        .silver-background {
            background: #bcbcbc
        }

        .teal {
            color: #006060
        }

        .teal-background {
            background: #007d7d
        }

        .white {
            color: #bfbfbf
        }

        .white-background {
            background: #fafafa
        }

        .yellow {
            color: #bfbf00
        }

        .yellow-background {
            background: #fafa00
        }

        span.icon > .fa {
            cursor: default
        }

        a span.icon > .fa {
            cursor: inherit
        }

        .admonitionblock td.icon [class^="fa icon-"] {
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
            cursor: default
        }

        .admonitionblock td.icon .icon-note::before {
            content: "\f05a";
            color: #19407c
        }

        .admonitionblock td.icon .icon-tip::before {
            content: "\f0eb";
            text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
            color: #111
        }

        .admonitionblock td.icon .icon-warning::before {
            content: "\f071";
            color: #bf6900
        }

        .admonitionblock td.icon .icon-caution::before {
            content: "\f06d";
            color: #bf3400
        }

        .admonitionblock td.icon .icon-important::before {
            content: "\f06a";
            color: #bf0000
        }

        .conum[data-value] {
            display: inline-block;
            color: #fff !important;
            background: rgba(0, 0, 0, .8);
            border-radius: 50%;
            text-align: center;
            font-size: .75em;
            width: 1.67em;
            height: 1.67em;
            line-height: 1.67em;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-style: normal;
            font-weight: bold
        }

        .conum[data-value] * {
            color: #fff !important
        }

        .conum[data-value] + b {
            display: none
        }

        .conum[data-value]::after {
            content: attr(data-value)
        }

        pre .conum[data-value] {
            position: relative;
            top: -.125em
        }

        b.conum * {
            color: inherit !important
        }

        .conum:not([data-value]):empty {
            display: none
        }

        dt, th.tableblock, td.content, div.footnote {
            text-rendering: optimizeLegibility
        }

        h1, h2, p, td.content, span.alt, summary {
            letter-spacing: -.01em
        }

        p strong, td.content strong, div.footnote strong {
            letter-spacing: -.005em
        }

        p, blockquote, dt, td.content, span.alt, summary {
            font-size: 1.0625rem
        }

        p {
            margin-bottom: 1.25rem
        }

        .sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock {
            font-size: 1em
        }

        .exampleblock > .content {
            background: #fffef7;
            border-color: #e0e0dc;
            box-shadow: 0 1px 4px #e0e0dc
        }

        .print-only {
            display: none !important
        }

        @page {
            margin: 1.25cm .75cm
        }

        @media print {
            * {
                box-shadow: none !important;
                text-shadow: none !important
            }

            html {
                font-size: 80%
            }

            a {
                color: inherit !important;
                text-decoration: underline !important
            }

            a.bare, a[href^="#"], a[href^="mailto:"] {
                text-decoration: none !important
            }

            a[href^="http:"]:not(.bare)::after, a[href^="https:"]:not(.bare)::after {
                content: "(" attr(href) ")";
                display: inline-block;
                font-size: .875em;
                padding-left: .25em
            }

            abbr[title] {
                border-bottom: 1px dotted
            }

            abbr[title]::after {
                content: " (" attr(title) ")"
            }

            pre, blockquote, tr, img, object, svg {
                page-break-inside: avoid
            }

            thead {
                display: table-header-group
            }

            svg {
                max-width: 100%
            }

            p, blockquote, dt, td.content {
                font-size: 1em;
                orphans: 3;
                widows: 3
            }

            h2, h3, #toctitle, .sidebarblock > .content > .title {
                page-break-after: avoid
            }

            #header, #content, #footnotes, #footer {
                max-width: none
            }

            #toc, .sidebarblock, .exampleblock > .content {
                background: none !important
            }

            #toc {
                border-bottom: 1px solid #dddddf !important;
                padding-bottom: 0 !important
            }

            body.book #header {
                text-align: center
            }

            body.book #header > h1:first-child {
                border: 0 !important;
                margin: 2.5em 0 1em
            }

            body.book #header .details {
                border: 0 !important;
                display: block;
                padding: 0 !important
            }

            body.book #header .details span:first-child {
                margin-left: 0 !important
            }

            body.book #header .details br {
                display: block
            }

            body.book #header .details br + span::before {
                content: none !important
            }

            body.book #toc {
                border: 0 !important;
                text-align: left !important;
                padding: 0 !important;
                margin: 0 !important
            }

            body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 {
                page-break-before: always
            }

            .listingblock code[data-lang]::before {
                display: block
            }

            #footer {
                padding: 0 .9375em
            }

            .hide-on-print {
                display: none !important
            }

            .print-only {
                display: block !important
            }

            .hide-for-print {
                display: none !important
            }

            .show-for-print {
                display: inherit !important
            }
        }

        @media amzn-kf8, print {
            #header > h1:first-child {
                margin-top: 1.25rem
            }

            .sect1 {
                padding: 0 !important
            }

            .sect1 + .sect1 {
                border: 0
            }

            #footer {
                background: none
            }

            .footer-text {
                color: rgba(0, 0, 0, .6);
                font-size: .9em
            }
        }

        @media amzn-kf8 {
            #header, #content, #footnotes, #footer {
                padding: 0
            }
        }
    </style>
</head>
<body class="article">
<div id="header">
    <h1>Introduction</h1>
</div>
<div id="content">
    <div id="preamble">
        <div class="sectionbody">
            <div class="paragraph">
                <p>My name is Oren Eini, and I have been working with (and on) databases for over 15 years. For the past
                    decade or so, I have been
                    involved in the creation of <a href="https://ravendb.net">RavenDB</a>, a distributed document
                    database. I have also been
                    involved in building other systems of similar nature such as queuing infrastructure, a distributed
                    hash table and the like.</p>
            </div>
            <div class="paragraph">
                <p>It turns out that at the bottom of the stack, you need a <em>good</em> way to store data to disk. I
                    have looked into many ways
                    to handle this, from simply writing XML or JSON file to a folder to utilizing existing software and
                    libraries such as
                    SQLite, LMDB, Esent, LevelDB and RocksDB. For quite some time, it has been my hobby to read through
                    any storage engine
                    codebase that I came across. And there have been many of those.</p>
            </div>
            <div class="paragraph">
                <p>This is a book that is going to cover how to build a database from the ground up. We aren&#8217;t
                    going to be talking about
                    the appropriate schema or what constraints to use. We are going to build the low level
                    infrastructure that you need in
                    order bo <em>build</em> a database engine, from scratch. At the level of putting bits on the disk.
                </p>
            </div>
            <div class="paragraph">
                <p>In particular, I want to walk through all the details of building a production quality
                    storage engine with full ACID (atomic, consistent, isolated and durable) properties, <em>real</em>
                    transactions and the ability
                    to store and operate on data in interesting manner.</p>
            </div>
            <div class="paragraph">
                <p>This book isn&#8217;t describing an existing storage engine and how it works. Instead, I wrote a new
                    storage engine specifically
                    for the book. And I wrote it <em>while</em> writing the book. In other words, I would the chapter on
                    implementing isolation between
                    transactions and then write the code to make that happen.</p>
            </div>
            <div class="paragraph">
                <p>The fact that I have to <em>explain</em> what the code does has had a profound impact on the
                    codebase. In many cases, I had to continuously
                    strip the code to its bare elements to be able to explain what it is doing, without unnecessary
                    details. That has mande the code
                    better, I think.</p>
            </div>
            <div class="paragraph">
                <p>There have been cases where I have opted to a simpler implementation strategy, at least initially, to
                    be able to explain how something
                    works incrementally. I&#8217;ve called out these details and if needed, we add onto them to get to a
                    more appropriate solution.</p>
            </div>
            <div class="paragraph">
                <p>The last part of the book is all about benchmarks. But instead of showing numbers, I have done
                    something quite different. I&#8217;m going
                    over the benchmark and <em>improving</em> them, so we have non trivial amount of optimization work
                    discussed there.</p>
            </div>
            <div class="paragraph">
                <p>All in all, this has been a fascinating project, I hope you&#8217;ll like it.</p>
            </div>
            <div class="ulist">
                <ul>
                    <li>
                        <p>Oren</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="sect1">
        <h2 id="_setting_up_expectations">Setting up expectations</h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>If you are interested in how storage engines work, I have written detailed reviews of my finding on
                    many such projects.
                    The following list contains some of those review, note that they are usually spread over to multiple
                    posts in a series.
                    I went through the code base and wrote my notes as they occurred to me.</p>
            </div>
            <div class="ulist">
                <ul>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/3607/reading-erlang">CouchDB</a> - Document
                            database written in Erlang.</p>
                    </li>
                    <li>
                        <p>
                            <a href="https://ayende.com/blog/posts/series/162754/reviewing-lightning-memory-mapped-database-library">LMDB</a>-
                            Low level
                            storage engine library written in C.</p>
                    </li>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/161410/reviewing-leveldb">LevelDB</a> - Low
                            level storage engine library from
                            Google. The basis for RocksDB from Facebook.</p>
                    </li>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/184225-A/reviewing-faster">FASTER</a> - Low
                            level storage engine from Microsoft.</p>
                    </li>
                    <li>
                        <p>
                            <a href="https://ayende.com/blog/posts/series/184066-C/reading-the-nsas-codebase">LemonGraph</a>
                            - Graph database by the NSA.</p>
                    </li>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/178497/reviewing-noise-search-engine">Noise</a>
                            - Full text search engine in Rust.</p>
                    </li>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/178945/reviewing-resin">Resin</a> - Document
                            database written in C#.</p>
                    </li>
                    <li>
                        <p><a href="https://ayende.com/blog/posts/series/186753-A/reviewing-sled">Sled</a> - Low level
                            storage engine written in Rust.</p>
                    </li>
                </ul>
            </div>
            <div class="paragraph">
                <p>I&#8217;ve also written my own storage engine library, based on the things that I have learned from
                    these reviews, experience
                    in the field and the needs of RavenDB itself. This storage engine is called Voron, we started
                    working on that in 2013
                    and has switched all of RavenDB to it completely by late 2015. Voron has been powering all RavenDB
                    production systems
                    for years, with very little trouble.</p>
            </div>
            <div class="sidebarblock">
                <div class="content">
                    <div class="title">Assumptions about the reader</div>
                    <div class="paragraph">
                        <p>I&#8217;m writing this book for fun, because it kept bouncing in my head and I really need to
                            get it out so I can sleep. Discussing
                            this book with my seven months old son would also put him to sleep more or less immediately,
                            which was a major bonus.</p>
                    </div>
                    <div class="paragraph">
                        <p>The target audience are developers over the age of seven months who have at least a passing
                            familiarity with system
                            level programming and the C language. I&#8217;m not going to find the most esoteric pieces
                            of C to use, but you are expected
                            to understand the C, native memory, data structures and the like.</p>
                    </div>
                    <div class="paragraph">
                        <p>I&#8217;ll reference other resources at times for additional materials, but I&#8217;m going
                            to focus on the storage engine rather than
                            reiterating existing knowledge. If additional knowledge isn&#8217;t critical to
                            understanding what is going on, I&#8217;ll refer you
                            elsewhere.</p>
                    </div>
                </div>
            </div>
            <div class="paragraph">
                <p>Voron is written in C# was built to be <em>high</em> performance and has been able to achieve
                    impressive benchmark numbers.
                    We have also built Voron to serve RavenDB and adapted RavenDB to best utilize Voron. That has been a
                    very benefitical
                    relationship for us because it allowed us to make certain that the operations we needed had as
                    little cost as possible.</p>
            </div>
            <div class="sect2">
                <h3 id="_why_this_book">Why this book?</h3>
                <div class="paragraph">
                    <p>I have written extensively about database building in the past. Again, each of these links is to
                        a <em>series</em> of posts that describe
                        certain aspects of building a database.</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>
                                <a href="https://ayende.com/blog/posts/series/174337/the-guts-n-glory-of-database-internals">The
                                    Guts n' Glory of Database Internals</a> -
                                A series of posts that walks through the challenges involved in building a proper
                                database and recommendations on how to deal
                                with them.</p>
                        </li>
                        <li>
                            <p><a href="https://ayende.com/blog/posts/series/175041/database-building-101">Database
                                building 101</a> - Series of posts detailing how to build
                                a graph database.</p>
                        </li>
                        <li>
                            <p><a href="https://ayende.com/blog/posts/series/175073/voron-internals">Voron internals</a>
                                - How Voron works behind the curtains.</p>
                        </li>
                        <li>
                            <p><a href="https://ayende.com/blog/posts/series/176961/low-level-voron-optimizations">Low
                                level Voron optimizations</a> - Discuss some
                                of the tricks we use to get Voron to be faster.</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>All of my work in Open Source. You can find RavenDB&#8217;s code at our <a
                            href="https://github.com/ravendb/ravendb">GitHub repository</a> and the
                        Voron project is the <code>src/Voron</code> directory there.</p>
                </div>
                <div class="paragraph">
                    <p>I spent a lot of time on building storage engines and I learned a lot from actual production
                        usage. This book started with me thinking
                        about how I would approach building a new storage engine without any existing constraints. Given
                        everything I know and a blank slate,
                        what would be the best storage engine that I could come up with?</p>
                </div>
                <div class="paragraph">
                    <p>Rather than just throw code over the wall, I wanted <em>explain</em> things and tell the complete
                        story. I&#8217;m also using this project as a way to
                        test out some interesting expriments that came to mind do proper research into additional
                        avenues and in general build something cool.</p>
                </div>
                <div class="paragraph">
                    <p>I hope that you&#8217;ll find this book interesting, it has certainly been interesting to write
                        it. This isn&#8217;t meant to be a theoretical
                        book, however. I&#8217;m going to walk through actual code, explain the reasoning behind what I&#8217;m
                        doing, the alternatives for the choices
                        I made as implemented by other products and the implications of those choices.</p>
                </div>
                <div class="paragraph">
                    <p>For more theoretical reading, I would recommend:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p><a href="https://www.databass.dev/">Database Internals</a> - Discuss implementation
                                details of database, both storage related and in the context
                                of distributed sytems. I found it facinating to read and I highly recommend it. It puts
                                you in the role of the implementor and go over
                                very important details in an approachable manner.</p>
                        </li>
                        <li>
                            <p><a href="https://dataintensive.net/">Designing data-intensive applications</a> - Go over
                                similar ground as Database Internals, but it does so from
                                a completely different perspective, the user. This is a great book to understand how to
                                make <em>use</em> of this knowledge. I think that these
                                books completement each other quite nicely.</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>I&#8217;m going to be talking about the road that <em>was</em> taken in this book. Whenever there
                        is a design choice to make, I&#8217;m going to call it out
                        and reference some of the other options, but I&#8217;m going to focus on the decisions that <em>were</em>
                        made, instead of exploring all the various
                        options.</p>
                </div>
                <div class="sidebarblock">
                    <div class="content">
                        <div class="title">Language and platform choices</div>
                        <div class="paragraph">
                            <p>I usually write code in C# and .NET, but I decided that I wanted to have the broadest
                                possible appeal for the engine, so I&#8217;m going to
                                be writing the engine in C. I <em>like</em> writing C code, because it is generally very
                                straight forward and there is nothing that isn&#8217;t
                                visible.</p>
                        </div>
                        <div class="paragraph">
                            <p>That said, error handling and resource management in C <em>sucks</em>. I spent some time
                                creating just enough infrastructure to be able to
                                write much nicer code without going crazy.</p>
                        </div>
                        <div class="paragraph">
                            <p>I&#8217;m going to target Linux as the first operating system to run the storage engine
                                on, but eventually we&#8217;ll run it on Linux, Windows
                                and Mac a minimum.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_what_is_a_storage_engine">What is a storage engine?</h3>
                <div class="paragraph">
                    <p>A storage engine in the context of this book is a library or API that are used to store data at a
                        very low level. It is the basic
                        building block of databases, queuing sytems, distributed architecture and more. You&#8217;ll
                        usually use a database, rather than a storage
                        engine directly, because a database would typically offer more capabilities.</p>
                </div>
                <div class="paragraph">
                    <p>For example, LemonGraph, mentioned above, is a graph database that is using LMDB as its storage
                        engine. RavenDB is a document database
                        that is using Voron as its storage engine. You can use a stroage engine directly, of course, if
                        you need to have access to the lowest
                        level of the system. RocksDB and LevelDB, for example, are very commonly used as backing store
                        for data for micro services, and LMDB
                        is also very well suited for this purpose.</p>
                </div>
                <div class="paragraph">
                    <p>Voron, RavenDB&#8217;s own storage engine, is written in C#, and as such is typically not
                        something that you can just use inside any application.
                        However, if you are running on .NET or CoreCLR, you&#8217;ll be able to make use of it
                        directly.</p>
                </div>
                <div class="admonitionblock note">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Note</div>
                            </td>
                            <td class="content">
                                <div class="title">Embedded storage engines vs. Databases</div>
                                <div class="paragraph">
                                    <p>An embedded storage engine is a library that you add to your application to
                                        manage storage details. The capabilities differs between
                                        libraries, of course, but the common theme is that they are all running inside
                                        your process and invoked directly by your code.
                                        A database, on the other hand, is usually running in its own process and you&#8217;ll
                                        communicate with it using the network.</p>
                                </div>
                                <div class="paragraph">
                                    <p>Embedded storage engines tend to offer lower level API than a database, they are
                                        one of the basic primitives that you&#8217;ll use when
                                        <em>building</em> a database. On the other hand, SQLite is both embedded library
                                        and a full database engine, so there is obviously some
                                        overlap.</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="paragraph">
                    <p>Storage engines are typically low level, offering primitive blocks that you can build on. One of
                        the reasons for this book is that
                        if you understand the undelrying primitives, and more importantly, why they exist, you can
                        design far better systems.</p>
                </div>
                <div class="paragraph">
                    <p>A storage engine stores data. The last staement may sounds like tautology, but it is important.
                        The core operations for a storage engine
                        are:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p><code>put(key, val)</code></p>
                        </li>
                        <li>
                            <p><code>val get(key)</code></p>
                        </li>
                        <li>
                            <p><code>bool del(key)</code></p>
                        </li>
                        <li>
                            <p><code>iterator iterate();</code></p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>Different storage engines implement these in different fashions, providing guarantees about the
                        data and how it is persisted. You <em>could</em>
                        write a storage engine that would simply store each value as a file in a directory. That <em>works</em>
                        and will mean that you have turned
                        the file system into your storage engine. That has issues, however. File systems tend to do
                        poorly with a lot of small values and there
                        are non trivial complexities regarding concurrency and atomicity of the data.</p>
                </div>
                <div class="paragraph">
                    <p>The goal of a storage engine is to take ownership of all those details and let the application
                        focus on doing its own thing. Quite often
                        you&#8217;ll see applications choosing and using a particular storage engine for the additional
                        behavior it provides: Secondary indexes, data
                        model that lends itself to merging, transactional guarantees, etc.</p>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_what_will_we_build">What will we build?</h3>
                <div class="paragraph">
                    <p>I have written quite a few storage engines at this point. Voron is obviously one of them, but I
                        have also written storage engines modeled
                        around LevelDB and Lucene as well as various tailored solutions for specific cases. Depending on
                        the scope of the problem, there is no end
                        to the amount of work you can put into a storage engine. There are always more to add and things
                        to improve. A whole team has been working
                        on and with Voron for over half a decade and we still have quite a list of features that we want
                        to add, for example.</p>
                </div>
                <div class="paragraph">
                    <p>To avoid such slippage in the book, I&#8217;m going to define the goals for the storage engine we&#8217;ll
                        be building up front. I have chosen the name
                        Gavran (Raven, Voron and Gavran are all the same word, in different languages), because typing
                        "storage engine" all the time is quite tiring.</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>Built in C, as it is meant to be embedded in other processes. Should compile with <code>-Wall
                                -Wextra -Werror</code> (enable warnings and treat
                                them as errors), pass Valgrind properly, etc.</p>
                        </li>
                        <li>
                            <p>Transactional and concurrent, you can have real ACID transactions with concurrent
                                transactions that allow readers to continue where there
                                are writes without blocking and vice versa.</p>
                        </li>
                        <li>
                            <p>Readable and usable, this is hard to define exactly, I admit. I <strong>care</strong>
                                about the API and the readability of the code, to the point where
                                I&#8217;ll jump through hoops to get more readable and understandable code. I&#8217;m
                                also going to try to put as much code directly in the book as
                                I can get away with. That means that the code should <em>fit</em>. Using the current
                                settings, I can fit about 45 lines of code on a printed
                                page, and I <em>really</em> want to avoid multi page code listing.</p>
                        </li>
                        <li>
                            <p>Good error handling. I&#8217;m spoiled, I like my errors to tell me exactly what is going
                                on and what to do about fixing it. That can be hard
                                to do properly in C, so we&#8217;ll have to tackle this as well. And yes, this is
                                important enough to be in the baseline acceptance criteria.</p>
                        </li>
                        <li>
                            <p>Performant, it should have high enough performance that it will not be an issue. My
                                intent is to get it to be placed around the top of
                                storage engine benchmarks.</p>
                        </li>
                        <li>
                            <p>Zero copy, should make it possible to get the data without copying from the database
                                buffers to the application buffers.</p>
                        </li>
                        <li>
                            <p>Cross platform, should be able to run on Linux, Windows, ARM devices, Android, iOS, etc.
                                Should run on 32 bits and 64 bits.</p>
                        </li>
                        <li>
                            <p>Support complex data structures, such as trees and maps in addition to the usual <code>get</code>,
                                <code>set</code>, <code>del</code> operations.</p>
                        </li>
                        <li>
                            <p>Small, I can&#8217;t commit to a number of lines of code, but I want it
                                <strong>small</strong>. To compare, LevelDB is about 20,000 lines of code and LMDB
                                is just over 10,000 lines of code. I aim to be somewhere in the middle.</p>
                        </li>
                    </ul>
                </div>
                <div class="admonitionblock tip">
                    <table>
                        <tr>
                            <td class="icon">
                                <div class="title">Tip</div>
                            </td>
                            <td class="content">
                                <div class="title">A note about concurrency</div>
                                <div class="paragraph">
                                    <p>Anyone who has written concurrent code can tell you that it is <em>hard</em>.
                                        Building a storage engine is hard enough, and doing that while being
                                        usable from multi threaded code is harder. I&#8217;m going to divide this work
                                        up, therefor.</p>
                                </div>
                                <div class="paragraph">
                                    <p>In the first two parts of the book, we are going to work completely single
                                        threaded, and then we&#8217;ll focus on adding multi threading to Gavran.
                                        The <em>design</em>, of course, is going to be multi threaded safe from the get
                                        go, but it is important to reduce the amount of complexity that we
                                        deal with at any given time.</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="paragraph">
                    <p>That is quite a list of features, but these are the <em>minimum</em> requirements, as far as I&#8217;m
                        concerned. My hope is that I can make the journey
                        there interesting along the way.</p>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_the_structure_of_this_book">The structure of this book</h3>
                <div class="paragraph">
                    <p>Building a storage engine is a non trivial task. There are many interlocked pieces that depend on
                        one another. In order to avoid confusion
                        we are going to be building the engine in stages, adding a single aspect at time. It means that
                        we are going to have to build some things
                        multiple times as we add additional functionality. By the same token, it means that you can see
                        the layers of the engine as it is built.</p>
                </div>
                <div class="paragraph">
                    <p>We&#8217;ll start each chapter with the a new feature to build, show the API that is required to
                        build it and sample and then discuss what is required
                        and the choices that were made at the API level. Then we&#8217;ll dive to the actual
                        implementation details. There is going to be a <em>lot</em> of (annotated)
                        code in this book, as well as deep dives into some aspects of building a storage engine.
                        We&#8217;ll close each chapter with unit tests showing the work that was done.</p>
                </div>
                <div class="paragraph">
                    <p>I&#8217;m going to try to show <em>all</em> the code that builds the engine in the book. You
                        should be able to sit down and type it all and get a working
                        storage engine. I&#8217;m assuming that you are going to be reading this on an electronic
                        device, not a physical medium, so you can probably make things
                        easier on yourself by using the code from the <a href="https://github.com/ayende/libgavran">book&#8217;s
                            GitHub repository</a>.</p>
                </div>
                <div class="sidebarblock">
                    <div class="content">
                        <div class="title">Requirements from the code</div>
                        <div class="paragraph">
                            <p>I am creating a new project here from scratch, which means that I&#8217;m not constrained
                                by past decisions. As such, I have decided to make sure that I&#8217;m
                                doing the best I can. Here are the rules that the codebase will follow:</p>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>The core API is written in C11 (<em>not</em> C++) and must compile with <code>-Wall
                                        -Wextra -Werror</code> enabled. Note that while we want <em>operating
                                        system</em> portability
                                        there is no hard requirement for <em>compiler</em> portability. I&#8217;m going
                                        to use some features that are available for GCC and Clang, but not MSVC and
                                        likely
                                        not in other C compilers. These features are going to significantly impact the
                                        code quality and there are workarounds for other compilers, I&#8217;m just not
                                        going to bother with these. Building the storage engine is large enough task as
                                        it is&#8230;&#8203;</p>
                                </li>
                                <li>
                                    <p>Functions and argument names will use <code>snake_case</code> formatting. And the
                                        naming convention for the function is <code>&lt;component&gt;_&lt;action&gt;_&lt;object&gt;</code>.
                                        So we&#8217;ll have <code>platform_sync_file</code> or
                                        <code>pager_allocate_page</code>.</p>
                                </li>
                                <li>
                                    <p>All integers should have their width specified, use <code>uint32_t</code> or
                                        <code>int64_t</code> instead of <code>unsigned long long</code>. The use of
                                        <code>size_t</code> is permitted, however.</p>
                                </li>
                                <li>
                                    <p>Functions using more than a few arguments should take a <code>struct</code>,
                                        instead.</p>
                                </li>
                                <li>
                                    <p>The code is automatically formatted using <code>clang-formatter</code> with the
                                        Mozilla&#8217;s style code and column limit set so it will fit properly in the
                                        book.</p>
                                </li>
                                <li>
                                    <p>The storage engine is going to be defined in layers, which each layer leaning on
                                        the previous one and isolating it. We&#8217;ll avoid chatter that cross layer
                                        boundary.</p>
                                </li>
                                <li>
                                    <p>The code will be unit tested and pass automated tooling such as Valgirnd / ASAN,
                                        etc.</p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="paragraph">
                    <p>One of the greatest weaknesses of C is in its error handling and the capabilities you have for
                        managing resources.
                        That is left entirely to the developer to manage. And while <em>technically</em> you can write
                        bug free code, it is a <em>hard</em> task.</p>
                </div>
                <div class="paragraph">
                    <p>I started working in Pascal, C and C++ but I spent most of my professional career working in
                        managed languages, mostly C# and .NET. That means that I
                        look at the sheer amount of ceremony to write proper code in C and I cringe. In order to enable
                        both good coding practices and maintain my sanity,
                        I have defined a set of baseline infrastructure that is going to help me write better and safer
                        code.</p>
                </div>
                <div class="paragraph">
                    <p>This infrastructure is inspired by the way OpenSSL built their error reporting systems as well as
                        the manner in which Rust manage errors. I also added
                        some Go flavor resource management to get a much more readable codebase. The very first thing
                        that we&#8217;ll do in this book is setup the appropriate infrastructure
                        to enable good resource management and error handling.</p>
                </div>
                <div class="paragraph">
                    <p>In <strong>Part II</strong> we&#8217;ll build the foundation of Gavran, the manners in which it
                        persist information to disk and manages transactions.</p>
                </div>
                <div class="paragraph">
                    <p>In <strong>Part III</strong> we&#8217;ll look into building data structures on top of the
                        persistence. We&#8217;ll use those to store actual user&#8217;s data.</p>
                </div>
                <div class="paragraph">
                    <p>In <strong>Part IV</strong> we&#8217;ll add multi threading support to Gavran.</p>
                </div>
                <div class="paragraph">
                    <p>In <strong>Part V</strong> we&#8217;ll run benchmarks and compare Gavran to other databases. Then
                        we&#8217;ll fix any performance issues that we&#8217;ll run into.</p>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_the_structure_of_the_codebase">The structure of the codebase</h3>
                <div class="paragraph">
                    <p>Before we get to the actual code, I wanted to have a rough overview of what the structure of
                        Gavran is going to look like. <a href="#foundation_structure">The structure of the foundation of
                            Gavran. Reading and writing from disk, on disk data format and how transactions are
                            implemented.</a> is showing
                        the architecture of Gavran&#8217;s foundation, which we&#8217;ll spent the first part of this
                        book implementing.</p>
                </div>
                <div id="foundation_structure" class="imageblock">
                    <div class="content">
                        <img src="../imgs/foundation-structure.png" alt="foundation structure">
                    </div>
                    <div class="title">Figure 1. The structure of the foundation of Gavran. Reading and writing from
                        disk, on disk data format and how transactions are implemented.
                    </div>
                </div>
                <div class="paragraph">
                    <p>The foundation of Gavran is responsible for reading and write data from disk, allocating disk
                        space and managing pages as well as implementing the transactional
                        guarantees. The foundation is <em>very</em> important, of course, but it is also not much use on
                        its on. We can only start doing interesting things with Gavran once
                        we implement data structures. These are layered on top of the foundation and can mostly ignore
                        all the persistence concerns. That is handled by the foundation&#8217;s layer.</p>
                </div>
                <div class="paragraph">
                    <p>Gavran supports the following data structures:</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>RAW data - used to store opaque binary data in Gavran and usually managed via an opaque
                                id.</p>
                        </li>
                        <li>
                            <p>Hash table - allows to do lookup by exact key match, but no range searches.</p>
                        </li>
                        <li>
                            <p>B+Tree - allows to search by key, or key prefix, or range searches.</p>
                        </li>
                    </ul>
                </div>
                <div class="paragraph">
                    <p>While this may seem like a small list, it is actually more than enough to implement sophisticated
                        behaviors.</p>
                </div>
                <div class="paragraph">
                    <p>Let&#8217;s get started building the foundation of Gavran&#8230;&#8203;</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="footer">
    <ul style="list-style-type: none;">
        <li><a class="footer-text" href="../index.html">Table of contents</a></li>
        <li><a class="footer-text" href="./ch02.html">Next chapter</a></li>
    </ul>
</div>
</body>
</html>